<div class="row">
  <div class="col-12">
    <div class="study-plan-page-top" style="background-image: url({{ studyPlan.icon }});"></div>

    <div [@fadeInOnEnter] class="study-plan study-plan-{{ studyPlan.id }}">
      <div class="study-plan-header">
        <div class="study-plan-icon">
          <img width="90" src="{{ studyPlan.icon }}" alt="">
        </div>
        <div class="study-plan-title text-dark">
          {{ studyPlan.title }}
        </div>
    
        <div class="study-plan-description text-dark">
          <div [innerHTML]="studyPlan.description"></div>
        </div>
      </div>
    
      <div class="row">
        <div class="col-lg-9 col-md-12 col-sm-12">

          <div class="study-plan-progress" *ngIf="studyPlan.isPurchased">
            <div class="card">
              <div class="card-header">
                <div class="card-title">
                  {{ 'Progress' | translate }}
                </div>
              </div>
            
              <div class="card-body">
                <div class="total">
                  <div class="chart">
                    <apx-chart
                      *ngIf="chartOptions"
                      [series]="chartOptions.series"
                      [chart]="chartOptions.chart"
                      [plotOptions]="chartOptions.plotOptions"
                      [labels]="chartOptions.labels"
                      [fill]="chartOptions.fill"
                      [stroke]="chartOptions.stroke"
                    ></apx-chart>
                  </div>
                </div>
                <div class="difficulties">
                  <swiper [config]="swiperConfig" class="swiper swiper-lazy-loading">
                    <div class="swiper-wrapper">
                      <div class="swiper-slide" *ngIf="difficulties?.allBeginner">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Beginner' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 1 | problemDifficultyColor }}">{{ difficulties.beginner }}</strong>
                              /
                              {{ difficulties.allBeginner }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 1 | problemDifficultyColor }}" [value]="100 * difficulties.beginner / difficulties.allBeginner"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                      <div class="swiper-slide" *ngIf="difficulties?.allBasic">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Basic' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 2 | problemDifficultyColor }}">{{ difficulties.basic }}</strong>
                              /
                              {{ difficulties.allBasic }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 2 | problemDifficultyColor }}" [value]="100 * difficulties.basic / difficulties.allBasic"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                      <div class="swiper-slide"  *ngIf="difficulties?.allNormal">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Normal' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 3 | problemDifficultyColor }}">{{ difficulties.normal }}</strong>
                              /
                              {{ difficulties.allNormal }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 3 | problemDifficultyColor }}" [value]="100 * difficulties.normal / difficulties.allNormal"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                      <div class="swiper-slide" *ngIf="difficulties?.allMedium">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Medium' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 4 | problemDifficultyColor }}">{{ difficulties.medium }}</strong>
                              /
                              {{ difficulties.allMedium }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 4 | problemDifficultyColor }}" [value]="100 * difficulties.medium / difficulties.allMedium"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                      <div class="swiper-slide" *ngIf="difficulties?.allAdvanced">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Advanced' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 5 | problemDifficultyColor }}">{{ difficulties.advanced }}</strong>
                              /
                              {{ difficulties.allAdvanced }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 5 | problemDifficultyColor }}" [value]="100 * difficulties.advanced / difficulties.allAdvanced"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                      <div class="swiper-slide" *ngIf="difficulties?.allHard">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Hard' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 6 | problemDifficultyColor }}">{{ difficulties.hard }}</strong>
                              /
                              {{ difficulties.allHard }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 6 | problemDifficultyColor }}" [value]="100 * difficulties.hard / difficulties.allHard"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                      <div class="swiper-slide" *ngIf="difficulties?.allExtremal">
                        <div class="difficulty">
                          <div class="d-flex justify-content-between info">
                            <div class="title">
                              {{ 'Extremal' | translate }}
                            </div>
                            <div class="solved">
                              <strong class="text-{{ 7 | problemDifficultyColor }}">{{ difficulties.extremal }}</strong>
                              /
                              {{ difficulties.allExtremal }}
                            </div>
                          </div>
                          <div class="mt-50 progress-wrapper">
                            <ngb-progressbar type="{{ 7 | problemDifficultyColor }}" [value]="100 * difficulties.extremal / difficulties.allExtremal"></ngb-progressbar>
                          </div>
                        </div>      
                      </div>
            
                    </div>
                  </swiper>
                </div>
              </div>
            </div>            
          </div>

          <div class="mb-2" *ngIf="!studyPlan.isPurchased">
            <div class="d-flex justify-content-center">
              <div class="study-plan-meta d-flex justify-content-between">
                <div class="info font-large-1" ngbTooltip="{{ 'Topics' | translate }}">
                  <i data-feather="activity" [size]="24"></i>
                  {{ studyPlan.daysCount }}
                </div>

                <div class="info font-large-1 ml-2" ngbTooltip="{{ 'Problems' | translate }}">
                  <i [data-feather]="'problem' | iconName" [size]="24"></i>
                  {{ studyPlan.problemsCount }}
                </div>
              </div>

              <div class="purchase-button">
                <kepcoin-spend-swal
                  [customContent]="true"
                  [purchaseUrl]="'study-plans/' + studyPlan.id + '/purchase/'"
                  (success)="purchaseSuccess()"
                  [value]="studyPlan.kepcoinValue">
                  <button class="ml-1 mt-50 text-white btn btn-relief-success btn-sm">
                    {{ 'Purchase' | translate }}
                  </button>
                </kepcoin-spend-swal>
              </div>
            </div>

          </div>

          <div [@fadeInOnEnter] class="study-plan-days">
            <div class="study-plan-day" *ngFor="let day of studyPlan.days">
              <div class="study-plan-day-title text-secondary">
                <span class="title text-dark">{{ day.title }}</span>
              </div>
    
              <div class="study-plan-day-description">
                <div [innerHTML]="day.description"></div>
              </div>
    
              <div class="card" *ngIf="day.problems?.length > 0">
                <div class="problems">
                  <div class="problem" [ngClass]="{
                    'bg-light-success': problem.hasSolved,
                    'bg-light-danger': !problem.hasSolved && problem.hasAttempted
                  }" *ngFor="let problem of day.problems">
                    <div class="problem-title text-dark">
                      {{ problem.id }}. {{ problem.title }}
                      <div class="problem-tags">
                        <span class="badge problem-tag badge-pill" *ngFor="let tag of problem.tags">
                          {{ tag.name }}
                        </span>
                      </div>  
                    </div>
    
                    <div class="problem-difficulty">
                      <span class="badge badge-glow badge-pill badge-{{ problem.difficulty | problemDifficultyColor }}">
                        {{ problem.difficultyTitle | translate }}
                      </span>        
                    </div>
    
                    <div class="problem-rating d-block">
                      <div class="likes-count">
                        <i data-feather="thumbs-up"></i>
                        {{ problem.likesCount }}
                      </div>
                      <div class="dislikes-count">
                        <i data-feather="thumbs-down"></i>
                        {{ problem.dislikesCount }}
                      </div>        
                    </div>
                    <div class="problem-button">
                      <a [routerLink]="['/practice', 'problems', 'problem', problem.id]"
                         [queryParams]="{'study-plan': studyPlan.id}"
                         rippleEffect class="text-white btn btn-primary btn-sm">
                        {{ 'Solve' | translate }}
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    
        <div class="col-lg-3 col-12">
          <h3 class="text-dark mb-1">{{ 'StudyPlans' | translate }}</h3>
          <study-plan-card [studyPlan]="studyPlan"></study-plan-card>
        </div>
      </div>
    </div>    
  </div>
</div>
